<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訓練日誌表單</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-section, .confirmation-section { margin-bottom: 20px; }
        label { display: block; margin-top: 10px; }
        input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; }
        .star-rating { display: flex; gap: 5px; }
        .star-rating input { display: none; }
        .star-rating label { cursor: pointer; font-size: 24px; color: #ccc; }
        .star-rating input:checked ~ label { color: #f90; }
        .star-rating input:checked + label { color: #f90; }
        button { padding: 10px 20px; margin: 10px 5px; }
    </style>
</head>
<body>
    <div class="form-section">
        <h1>訓練日誌表單</h1>
        <form id="trainingForm">
            <label>姓名 * <input type="text" name="name" required></label>
            <label>日期 * <input type="date" name="date" required></label>
            <label>訓練類型 *
                <select name="trainingType" required>
                    <option value="">請選擇訓練類型</option>
                    <option value="搏擊">搏擊</option>
                    <option value="搏擊(港隊)">搏擊(港隊)</option>
                    <option value="品勢">品勢</option>
                    <option value="品勢(港隊)">品勢(港隊)</option>
                    <option value="體能">體能</option>
                    <option value="綜合">綜合</option>
                </select>
            </label>
            <label>體重(練習前) * <input type="number" step="0.1" name="weightBefore" required></label>
            <label>體重(練習後) * <input type="number" step="0.1" name="weightAfter" required></label>
            <label>訓練內容 * <textarea name="trainingContent" required></textarea></label>
            <label>訓練辛苦程度評分 * (10=好辛苦, 5=一般, 1=好輕鬆)
                <div class="star-rating">
                    <input type="radio" name="effortRating" value="10" id="effort10" required><label for="effort10">★</label>
                    <input type="radio" name="effortRating" value="9" id="effort9"><label for="effort9">★</label>
                    <input type="radio" name="effortRating" value="8" id="effort8"><label for="effort8">★</label>
                    <input type="radio" name="effortRating" value="7" id="effort7"><label for="effort7">★</label>
                    <input type="radio" name="effortRating" value="6" id="effort6"><label for="effort6">★</label>
                    <input type="radio" name="effortRating" value="5" id="effort5"><label for="effort5">★</label>
                    <input type="radio" name="effortRating" value="4" id="effort4"><label for="effort4">★</label>
                    <input type="radio" name="effortRating" value="3" id="effort3"><label for="effort3">★</label>
                    <input type="radio" name="effortRating" value="2" id="effort2"><label for="effort2">★</label>
                    <input type="radio" name="effortRating" value="1" id="effort1"><label for="effort1">★</label>
                </div>
            </label>
            <label>主觀努力投入評分 * (10=能努力投入, 5=一般, 1=不能投入)
                <div class="star-rating">
                    <input type="radio" name="engagementRating" value="10" id="engage10" required><label for="engage10">★</label>
                    <input type="radio" name="engagementRating" value="9" id="engage9"><label for="engage9">★</label>
                    <input type="radio" name="engagementRating" value="8" id="engage8"><label for="engage8">★</label>
                    <input type="radio" name="engagementRating" value="7" id="engage7"><label for="engage7">★</label>
                    <input type="radio" name="engagementRating" value="6" id="engage6"><label for="engage6">★</label>
                    <input type="radio" name="engagementRating" value="5" id="engage5"><label for="engage5">★</label>
                    <input type="radio" name="engagementRating" value="4" id="engage4"><label for="engage4">★</label>
                    <input type="radio" name="engagementRating" value="3" id="engage3"><label for="engage3">★</label>
                    <input type="radio" name="engagementRating" value="2" id="engage2"><label for="engage2">★</label>
                    <input type="radio" name="engagementRating" value="1" id="engage1"><label for="engage1">★</label>
                </div>
            </label>
            <label>訓練感受 * <textarea name="trainingFeeling" required></textarea></label>
            <label>是否有不適或疼痛？ *
                <input type="radio" name="discomfort" value="是" id="discomfortYes" required><label for="discomfortYes">是</label>
                <input type="radio" name="discomfort" value="否" id="discomfortNo"><label for="discomfortNo">否</label>
            </label>
            <label>如有請描述一下 <textarea name="discomfortDescription"></textarea></label>
            <label>當天飲食 * <textarea name="diet" required></textarea></label>
            <label>睡眠時數 *
                <select name="sleepHours" required>
                    <option value="">請選擇睡眠時數</option>
                    <option value="10小時">10小時</option>
                    <option value="9小時">9小時</option>
                    <option value="8小時">8小時</option>
                    <option value="7小時">7小時</option>
                    <option value="6小時">6小時</option>
                    <option value="5小時">5小時</option>
                    <option value="4小時">4小時</option>
                    <option value="3小時">3小時</option>
                    <option value="2小時">2小時</option>
                    <option value="1小時">1小時</option>
                    <option value="沒有">沒有</option>
                </select>
            </label>
            <label>睡眠質量 *
                <select name="sleepQuality" required>
                    <option value="">請選擇睡眠質量</option>
                    <option value="質量很好">質量很好</option>
                    <option value="質量一般">質量一般</option>
                    <option value="質量不好">質量不好</option>
                </select>
            </label>
            <label>精神狀態 *
                <input type="radio" name="mentalState" value="精力充沛" id="mentalEnergetic" required><label for="mentalEnergetic">精力充沛</label>
                <input type="radio" name="mentalState" value="一般" id="mentalNormal"><label for="mentalNormal">一般</label>
                <input type="radio" name="mentalState" value="疲憊" id="mentalTired"><label for="mentalTired">疲憊</label>
            </label>
            <label>肌肉狀態 *
                <input type="radio" name="muscleState" value="精力充沛" id="muscleEnergetic" required><label for="muscleEnergetic">精力充沛</label>
                <input type="radio" name="muscleState" value="一般" id="muscleNormal"><label for="muscleNormal">一般</label>
                <input type="radio" name="muscleState" value="疲勞" id="muscleTired"><label for="muscleTired">疲勞</label>
            </label>
            <label>上次訓練恢復狀態 *
                <input type="radio" name="recoveryState" value="完全恢復" id="recoveryFull" required><label for="recoveryFull">完全恢復</label>
                <input type="radio" name="recoveryState" value="仍有少少疲勞" id="recoveryPartial"><label for="recoveryPartial">仍有少少疲勞</label>
                <input type="radio" name="recoveryState" value="非常疲勞" id="recoveryTired"><label for="recoveryTired">非常疲勞</label>
            </label>
            <label>其他反饋與問題 <textarea name="feedback"></textarea></label>
            <label>給自己的鼓勵 * <textarea name="encouragement" required></textarea></label>
            <button type="submit">提交表單</button>
            <button type="button" onclick="resetForm()">重新記錄</button>
        </form>
    </div>

    <div class="confirmation-section" style="display: none;">
        <h1>請確認您的訓練日誌</h1>
        <p>姓名：<span id="confirmName"></span></p>
        <p>日期：<span id="confirmDate"></span></p>
        <p>訓練類型：<span id="confirmTrainingType"></span></p>
        <p>體重(練習前)：<span id="confirmWeightBefore"></span></p>
        <p>體重(練習後)：<span id="confirmWeightAfter"></span></p>
        <p>訓練內容：<span id="confirmTrainingContent"></span></p>
        <p>訓練辛苦程度評分：<span id="confirmEffortRating"></span></p>
        <p>主觀努力投入評分：<span id="confirmEngagementRating"></span></p>
        <p>訓練感受：<span id="confirmTrainingFeeling"></span></p>
        <p>是否有不適或疼痛：<span id="confirmDiscomfort"></span></p>
        <p>不適或疼痛描述：<span id="confirmDiscomfortDescription"></span></p>
        <p>當天飲食：<span id="confirmDiet"></span></p>
        <p>睡眠時數：<span id="confirmSleepHours"></span></p>
        <p>睡眠質量：<span id="confirmSleepQuality"></span></p>
        <p>精神狀態：<span id="confirmMentalState"></span></p>
        <p>肌肉狀態：<span id="confirmMuscleState"></span></p>
        <p>上次訓練恢復狀態：<span id="confirmRecoveryState"></span></p>
        <p>其他反饋與問題：<span id="confirmFeedback"></span></p>
        <p>給自己的鼓勵：<span id="confirmEncouragement"></span></p>
        <button onclick="cancelSubmission()">取消</button>
        <button onclick="confirmSubmission()">確認提交</button>
    </div>

    <script>
        function resetForm() {
            document.getElementById('trainingForm').reset();
            window.history.back();
        }

        document.getElementById('trainingForm').addEventListener('submit', function(event) {
            event.preventDefault();
            document.querySelector('.form-section').style.display = 'none';
            document.querySelector('.confirmation-section').style.display = 'block';

            document.getElementById('confirmName').textContent = this.name.value;
            document.getElementById('confirmDate').textContent = this.date.value;
            document.getElementById('confirmTrainingType').textContent = this.trainingType.value;
            document.getElementById('confirmWeightBefore').textContent = this.weightBefore.value;
            document.getElementById('confirmWeightAfter').textContent = this.weightAfter.value;
            document.getElementById('confirmTrainingContent').textContent = this.trainingContent.value;
            document.getElementById('confirmEffortRating').textContent = this.effortRating.value;
            document.getElementById('confirmEngagementRating').textContent = this.engagementRating.value;
            document.getElementById('confirmTrainingFeeling').textContent = this.trainingFeeling.value;
            document.getElementById('confirmDiscomfort').textContent = this.discomfort.value;
            document.getElementById('confirmDiscomfortDescription').textContent = this.discomfortDescription.value;
            document.getElementById('confirmDiet').textContent = this.diet.value;
            document.getElementById('confirmSleepHours').textContent = this.sleepHours.value;
            document.getElementById('confirmSleepQuality').textContent = this.sleepQuality.value;
            document.getElementById('confirmMentalState').textContent = this.mentalState.value;
            document.getElementById('confirmMuscleState').textContent = this.muscleState.value;
            document.getElementById('confirmRecoveryState').textContent = this.recoveryState.value;
            document.getElementById('confirmFeedback').textContent = this.feedback.value;
            document.getElementById('confirmEncouragement').textContent = this.encouragement.value;
        });

        function cancelSubmission() {
            document.querySelector('.form-section').style.display = 'block';
            document.querySelector('.confirmation-section').style.display = 'none';
        }

        function confirmSubmission() {
            alert('表單已提交！');
            resetForm();
        }
    </script>
</body>
</html>